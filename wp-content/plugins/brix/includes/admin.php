<?php if ( ! defined( 'ABSPATH' ) ) die( 'Forbidden' );

/**
 * Alter the admin heading page title for the plugin option pages.
 *
 * @since 1.0.0
 * @param string $title The page title.
 * @return string
 */
function brix_admin_page_heading_title( $title ) {
	$title = 'Brix';

	return $title;
}

add_filter( 'brix_admin_page_heading_title[group:brix]', 'brix_admin_page_heading_title' );

/**
 * Check if the theme has been correctly installed.
 *
 * @since 1.0.0
 * @return boolean
 */
function brix_install_check() {
	return (bool) get_option( brix_install_key() ) == '1';
}

/**
 * Get the theme key string. Returns the theme's folder, or the theme's parent's
 * folder.
 *
 * @since 1.0.0
 * @return string
 */
function brix_install_get_brix_key() {
	$brix_key = 'brix';

	return $brix_key;
}

/**
 * Get the installation key string.
 *
 * @since 1.0.0
 * @return string
 */
function brix_install_key() {
	$key = brix_install_get_brix_key();

	return $key . '_installed';
}

/**
 * Optionally complete the installation procedure.
 *
 * @since 1.0.0
 */
function brix_maybe_install_complete() {
	$install_complete = true;

	if ( $install_complete ) {
		update_option( brix_install_key(), '1' );
	}
}

/* Require the install procedure only when needed. */
if ( ! brix_install_check() ) {
	require_once( BRIX_INSTALL_FOLDER . '/includes/install/install.php' );
}

/**
 * Display a customized notice.
 *
 * @since 1.0.0
 * @param string $message The notice content.
 */
function brix_notice( $message, $title = 'Brix' ) {
	echo '<div class="brix-notice">';
		echo '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="444" height="680" viewBox="0 0 444 680" version="1.1"><title>Brix builder</title><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="logo" transform="translate(-128.000000, -127.000000)"><g id="Group-2" transform="translate(128.000000, 127.000000)"><g id="logo"><path d="M204.67 5C214.24-0.52 229.76-0.52 239.33 5L426.38 113C435.94 118.52 443.7 131.96 443.7 143.01L443.7 358.99C443.7 370.04 435.94 383.48 426.38 389L239.33 497C229.76 502.52 214.24 502.52 204.67 497L17.62 389C8.06 383.48 0.3 370.04 0.3 358.99L0.3 143.01C0.3 131.96 8.06 118.52 17.62 113L204.67 5ZM213.34 40C218.12 37.24 225.89 37.24 230.66 40L400.4 138C405.18 140.76 409.06 147.49 409.06 153L409.06 349C409.06 354.52 405.18 361.24 400.4 364L230.66 462C225.88 464.76 218.11 464.76 213.34 462L43.6 364C38.82 361.24 34.94 354.51 34.94 349L34.94 153C34.94 147.48 38.82 140.76 43.6 138L213.34 40Z" id="Polygon-1" fill="#3E6274"/><path d="M221.48 325.28L157.41 288.23 157.41 213.71 285.65 139.15 341.98 171.74C346.77 174.51 350.65 181.24 350.65 186.76L350.65 315.28C350.65 320.8 346.77 327.53 341.99 330.28L221.48 399.85 221.48 325.28Z" id="Rectangle-1" fill="#CDDC39"/><path d="M101.53 181.99C96.75 179.22 96.75 174.74 101.53 171.98L213.37 107.44C218.15 104.68 225.91 104.69 230.69 107.44L342.48 171.98C347.26 174.75 347.26 179.23 342.48 181.99L222.03 251.57 101.53 181.99Z" id="Rectangle-1" fill="#D9EB3D"/></g><path d="M16.87 613.71L74.04 613.71C78.46 613.71 82.21 612.17 85.28 609.1 88.42 605.97 89.99 602.2 89.99 597.78 89.99 593.42 88.42 589.68 85.28 586.55 82.21 583.42 78.46 581.85 74.04 581.85L16.87 581.85 16.87 613.71ZM16.87 662.42L74.04 662.42C78.46 662.42 82.21 660.85 85.28 657.72 88.42 654.65 89.99 650.91 89.99 646.49 89.99 642.13 88.42 638.39 85.28 635.26 82.21 632.13 78.46 630.56 74.04 630.56L16.87 630.56 16.87 662.42ZM8.48 679.27C6.13 679.27 4.11 678.46 2.43 676.84 0.81 675.16 0 673.15 0 670.8L0 573.47C0 571.12 0.81 569.14 2.43 567.52 4.11 565.84 6.13 565 8.48 565L74.04 565C83.1 565 90.85 568.21 97.29 574.64 103.67 581.07 106.86 588.78 106.86 597.78 106.86 607.51 103.25 615.64 96.03 622.18 103.25 628.66 106.86 636.76 106.86 646.49 106.86 655.54 103.67 663.26 97.29 669.63 90.85 676.06 83.1 679.27 74.04 679.27L8.48 679.27ZM249.23 597.78C249.23 588.78 246.04 581.07 239.66 574.64 233.23 568.21 225.47 565 216.41 565L150.85 565C148.5 565 146.49 565.84 144.81 567.52 143.18 569.14 142.37 571.12 142.37 573.47 142.37 575.82 143.18 577.8 144.81 579.42 146.49 581.04 148.5 581.85 150.85 581.85L216.41 581.85C220.83 581.85 224.58 583.42 227.66 586.55 230.79 589.68 232.36 593.42 232.36 597.78 232.36 602.2 230.79 605.97 227.66 609.1 224.58 612.17 220.83 613.71 216.41 613.71L150.85 613.71C148.5 613.71 146.49 614.55 144.81 616.22 143.18 617.85 142.37 619.83 142.37 622.18 142.37 624.47 143.18 626.45 144.81 628.13 146.49 629.75 148.5 630.56 150.85 630.56L210.78 630.56C216.77 630.56 221.87 632.68 226.06 636.93 230.26 641.12 232.36 646.18 232.36 652.11L232.36 670.8C232.36 673.15 233.2 675.16 234.88 676.84 236.5 678.46 238.49 679.27 240.84 679.27 243.13 679.27 245.12 678.46 246.8 676.84 248.42 675.16 249.23 673.15 249.23 670.8L249.23 652.11C249.23 640.76 245.01 631.29 236.55 623.69 245.01 617.09 249.23 608.46 249.23 597.78L249.23 597.78ZM287.18 676.84C285.56 675.16 284.74 673.15 284.74 670.8L284.74 573.47C284.74 571.12 285.56 569.14 287.18 567.52 288.86 565.84 290.87 565 293.22 565 295.52 565 297.5 565.84 299.18 567.52 300.81 569.14 301.62 571.12 301.62 573.47L301.62 670.8C301.62 673.15 300.81 675.16 299.18 676.84 297.5 678.46 295.52 679.27 293.22 679.27 290.87 679.27 288.86 678.46 287.18 676.84L287.18 676.84ZM443.99 573.47C443.99 571.12 443.18 569.14 441.56 567.52 439.88 565.84 437.89 565 435.6 565 433.25 565 431.26 565.84 429.64 567.52 427.96 569.14 427.12 571.12 427.12 573.47L427.12 592.16C427.12 598.14 425.02 603.23 420.82 607.42 416.62 611.61 411.53 613.71 405.54 613.71L375.58 613.71C369.65 613.71 364.55 611.61 360.3 607.42 356.1 603.23 354 598.14 354 592.16L354 573.47C354 571.12 353.19 569.14 351.57 567.52 349.89 565.84 347.9 565 345.61 565 343.26 565 341.25 565.84 339.57 567.52 337.94 569.14 337.13 571.12 337.13 573.47L337.13 592.16C337.13 604.46 341.94 614.46 351.57 622.18 341.94 629.89 337.13 639.87 337.13 652.11L337.13 670.8C337.13 673.15 337.94 675.16 339.57 676.84 341.25 678.46 343.26 679.27 345.61 679.27 347.9 679.27 349.89 678.46 351.57 676.84 353.19 675.16 354 673.15 354 670.8L354 652.11C354 646.18 356.1 641.12 360.3 636.93 364.55 632.68 369.65 630.56 375.58 630.56L405.54 630.56C411.53 630.56 416.62 632.68 420.82 636.93 425.02 641.12 427.12 646.18 427.12 652.11L427.12 670.8C427.12 673.15 427.96 675.16 429.64 676.84 431.26 678.46 433.25 679.27 435.6 679.27 437.89 679.27 439.88 678.46 441.56 676.84 443.18 675.16 443.99 673.15 443.99 670.8L443.99 652.11C443.99 639.87 439.18 629.89 429.55 622.18 439.18 614.46 443.99 604.46 443.99 592.16L443.99 573.47Z" fill="#3E6274"/></g></g></g></svg>';

		echo '<div class="brix-notice-message">';
			echo '<p class="brix-notice-title"><strong>' . esc_html( $title ) . '</strong></p>';
			echo $message;
		echo '</div>';
	echo '</div>';
}

/**
 * Output the social icons in Brix option pages.
 *
 * @since 1.1.3
 */
function brix_social_icons() {
	?>
		<ul class="brix-admin-social-toolbar">
			<li>
				<a href="https://twitter.com/brixbuilder" target="_blank" rel="noopener noreferrer">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24" version="1.1"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="twitter" fill="#000000"><path d="M24 4.31C23.32 5.31 22.49 6.16 21.53 6.86 21.54 7 21.55 7.21 21.55 7.5 21.55 8.82 21.35 10.13 20.97 11.45 20.58 12.76 20 14.02 19.21 15.23 18.42 16.44 17.49 17.51 16.4 18.44 15.31 19.37 14 20.11 12.47 20.66 10.94 21.21 9.3 21.49 7.55 21.49 4.8 21.49 2.28 20.75 0 19.28 0.36 19.32 0.75 19.34 1.19 19.34 3.47 19.34 5.51 18.64 7.29 17.24 6.23 17.22 5.27 16.89 4.43 16.26 3.59 15.63 3.01 14.82 2.7 13.83 3.03 13.88 3.34 13.91 3.62 13.91 4.06 13.91 4.49 13.85 4.92 13.74 3.78 13.51 2.84 12.94 2.09 12.04 1.35 11.14 0.97 10.1 0.97 8.91L0.97 8.85C1.66 9.24 2.41 9.45 3.2 9.48 2.53 9.03 1.99 8.45 1.6 7.73 1.2 7 1 6.22 1 5.38 1 4.49 1.23 3.66 1.67 2.9 2.9 4.41 4.4 5.62 6.16 6.53 7.92 7.44 9.81 7.94 11.82 8.04 11.73 7.66 11.69 7.28 11.69 6.92 11.69 5.56 12.17 4.4 13.13 3.44 14.09 2.48 15.25 2 16.61 2 18.03 2 19.23 2.52 20.21 3.55 21.31 3.34 22.35 2.94 23.33 2.37 22.95 3.53 22.23 4.44 21.16 5.08 22.11 4.97 23.05 4.72 24 4.31L24 4.31Z" id="Page-1"/></g></g></svg>
					<span class="screen-reader-text">Twitter</span>
				</a>
			</li>
			<li>
				<a href="https://www.facebook.com/brixbuilderwp/" target="_blank" rel="noopener noreferrer">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24" version="1.1"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="facebook" fill="#000000"><path d="M18.46 0.17L18.46 3.98 16.2 3.98C15.37 3.98 14.81 4.15 14.52 4.5 14.24 4.85 14.09 5.37 14.09 6.06L14.09 8.78 18.32 8.78 17.75 13.05 14.09 13.05 14.09 24 9.68 24 9.68 13.05 6 13.05 6 8.78 9.68 8.78 9.68 5.64C9.68 3.85 10.18 2.46 11.18 1.48 12.18 0.49 13.51 0 15.17 0 16.59 0 17.68 0.06 18.46 0.17L18.46 0.17Z" id="Page-1"/></g></g></svg>
					<span class="screen-reader-text">Facebook</span>
				</a>
			</li>
			<li>
				<a href="http://eepurl.com/bKMcG5" target="_blank" rel="noopener noreferrer">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24" version="1.1"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="newsletter" fill="#000000"><path d="M12 8.5L7.5 8.5 7.5 13 12 13 12 8.5ZM13.5 16L13.5 17.5 6 17.5 6 16 13.5 16ZM13.5 7L13.5 14.5 6 14.5 6 7 13.5 7ZM21 16L21 17.5 15 17.5 15 16 21 16ZM21 13L21 14.5 15 14.5 15 13 21 13ZM21 10L21 11.5 15 11.5 15 10 21 10ZM21 7L21 8.5 15 8.5 15 7 21 7ZM3 18.25L3 7 1.5 7 1.5 18.25C1.5 18.45 1.57 18.63 1.72 18.78 1.87 18.93 2.05 19 2.25 19 2.45 19 2.63 18.93 2.78 18.78 2.93 18.63 3 18.45 3 18.25L3 18.25ZM22.5 18.25L22.5 5.5 4.5 5.5 4.5 18.25C4.5 18.51 4.46 18.76 4.37 19L21.75 19C21.95 19 22.13 18.93 22.28 18.78 22.43 18.63 22.5 18.45 22.5 18.25L22.5 18.25ZM24 4L24 18.25C24 18.88 23.78 19.41 23.34 19.84 22.91 20.28 22.38 20.5 21.75 20.5L2.25 20.5C1.62 20.5 1.09 20.28 0.66 19.84 0.22 19.41 0 18.88 0 18.25L0 5.5 3 5.5 3 4 24 4Z" id="Page-1"/></g></g></svg>
					<span class="screen-reader-text"><?php esc_html_e( 'Newsletter', 'brix' ); ?></span>
				</a>
			</li>
		</ul>
	<?php
}

add_action( 'brix_admin_page_subheading[group:brix]', 'brix_social_icons' );