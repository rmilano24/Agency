!function(e){"use strict";window.brix_frontend_editing=new function(){var t=this;t.$ref=null,t.$el=null,t.$hover_ref=null,t.$hover_el=e(".brix-frontend-editing-el-hover"),t.select_element='<div class="brix-frontend-editing-el-selected"></div>',this.update=function(e){window.parent.brix_frontend_editing.update(e)},this.enter=function(n){if(t.clear_hover(!1),null===t.$hover_ref&&n){var i=!1;if(e(n.target).is("[data-frontend-editing]")?i=e(n.target):e(n.target).parents("[data-frontend-editing]").length&&(i=e(n.target).parents("[data-frontend-editing]").first()),!1===i)return;if(i.parents(".brix-frontend-editing-no-hover").length)return;t.$hover_ref=i}if(t.$hover_el&&t.$hover_ref){t.$hover_el.addClass("brix-frontend-editing-el-hover-active");var r="";t.$hover_ref.hasClass("brix-section-column-block")?r="block":t.$hover_ref.hasClass("brix-section-column")?r="column":t.$hover_ref.hasClass("brix-section-row")?r="row":t.$hover_ref.hasClass("brix-section")&&(r="section"),t.$hover_el.attr("data-context",r);var o={top:t.$hover_ref.offset().top,left:t.$hover_ref.offset().left,width:t.$hover_ref.outerWidth(),height:t.$hover_ref.outerHeight()},s={top:t.$hover_el.offset().top,left:t.$hover_el.offset().left,width:t.$hover_el.outerWidth(),height:t.$hover_el.outerHeight()};JSON.stringify(o)!=JSON.stringify(s)&&t.$hover_el.css({top:t.$hover_ref.offset().top,left:t.$hover_ref.offset().left,width:t.$hover_ref.outerWidth(),height:t.$hover_ref.outerHeight()})}},this.clear_hover=function(e){void 0===e&&(e=!0),t.$hover_el.removeClass("brix-frontend-editing-el-hover-active"),t.$hover_el.attr("data-context",""),e&&t.$hover_el.css({top:"",left:"",width:"",height:""}),t.$hover_ref=null},this.position=function(){if(t.enter(),null!=t.$el&&null!=t.$ref){e(".brix-frontend-guide").remove();var n=e("<span class='brix-frontend-guide brix-frontend-vertical-guide'></span>"),i=e("<span class='brix-frontend-guide brix-frontend-vertical-guide'></span>"),r=e("<span class='brix-frontend-guide brix-frontend-horizontal-guide'></span>"),o=e("<span class='brix-frontend-guide brix-frontend-horizontal-guide'></span>");n.insertAfter(t.$el),i.insertAfter(t.$el),r.insertAfter(t.$el),o.insertAfter(t.$el);var s=t.$ref.offset().top,c=t.$ref.offset().left,d=t.$ref.outerWidth(),a=t.$ref.outerHeight(),l=c+d,f=s+a,h=-1*e(window).scrollTop(),b=-1*e(window).scrollLeft();setTimeout(function(){n.css("left",c+b),i.css("left",l+b-1),r.css("top",s+h),o.css("top",f+h-1),t.$el.css({top:s,left:c,width:d,height:a})},5)}},this.detect=function(){if(t.$ref&&t.$ref[0]===this)return t.clear(),!1;t.clear();var n="",i=parseInt(e(this).attr("data-count")),r={special:!1};e(this).hasClass("brix-section-column-block")?(n="block",i=e(this).index(".brix-section-column-block")):e(this).hasClass("brix-section-column")?(n="column",i=e(this).index(".brix-section-column")):e(this).hasClass("brix-section-row")?(n="row",i=e(this).index(".brix-section-row")):e(this).hasClass("brix-section")&&(n="section",i=e(this).index(".brix-section")),e(this).parents(".brix-subsection-type-special").length&&(r.special=!0),window.parent.brix_frontend_editing.change_context(n,i,r);var o=e(t.select_element);return t.$ref=e(this),!t.$ref.parents(".brix-frontend-editing-no-hover").length&&(t.$el=o,e("body").append(o),t.position(),!1)},this.clear=function(){t.clear_hover(),window.parent.brix_frontend_editing.change_context("",0),e(".brix-frontend-editing-el-selected").remove(),e(".brix-frontend-editing-element-selected").removeClass("brix-frontend-editing-element-selected"),e(".brix-frontend-guide").remove(),t.$ref=null,t.$el=null},this.select=function(n,i){var r={special:!1};switch(n){case"section":t.detect.apply(e(".brix-section").eq(i).get(0));break;case"row":t.detect.apply(e(".brix-section-row").eq(i).get(0));break;case"column":t.detect.apply(e(".brix-section-column").eq(i).get(0));break;case"block":t.detect.apply(e(".brix-section-column-block").eq(i).get(0))}t.$ref.parents(".brix-subsection-type-special").length&&(r.special=!0),window.parent.brix_frontend_editing.change_context(n,i,r)},this.add_block=function(){var t=e(this).parents(".brix-section-column-block").first(),n=e(this).parents(".brix-section-column").first().index(".brix-section-column"),i=null;return t&&(i=t.index()),window.parent.brix_frontend_editing.add_block(n,i),!1},this.add_section=function(){var t=e(".brix-section");t.length?window.parent.brix_frontend_editing.add_section(t.length-1):window.parent.brix_frontend_editing.add_section()},this.adjustments=function(){e(window).on("resize scroll",t.position),e(document).on("dragStart.flickity",".brix-section-column-carousel .brix-section-column-inner-wrapper",function(){t.clear(),e(this).addClass("brix-frontend-editing-no-hover")}),e(document).on("settle.flickity",".brix-section-column-carousel .brix-section-column-inner-wrapper",function(){t.clear(),e(this).removeClass("brix-frontend-editing-no-hover")}),e(document).on("switched.brixf.tabs",".brix-tabs.brix-component",t.position),e(document).on("switched.brixf.accordion",".brix-accordion.brix-component",t.position),e(document).on("brix-img-loaded",".brix-block-image-img",t.position),e(document).on("brix-icon-loaded",".brix-icon[data-src]",t.position),e(document).on("click",".brix-frontend-editing-add-section",t.add_section)},this.bind=function(){e(document).on("click","[data-frontend-editing]",this.detect),e(document).on("mousemove","[data-frontend-editing]",this.enter),e(document).on("mouseleave","[data-frontend-editing]",this.clear_hover),e(document).on("click","[data-frontend-editing] .brix-frontend-add-block",this.add_block),e("body.woocommerce-active").length&&e(window).on("brix_ready",function(){e(document.body).trigger("wc_fragment_refresh")}),t.adjustments()},this.init=function(){this.bind()},this.init()}}(jQuery),function(e){"use strict";var t=".brix-section-column-inner-wrapper:not([data-carousel])",n=function(t){if(e(t).is(".brix-section-column-block")){var n=".brix-section-column-inner-wrapper";e(n).css("min-height","");var i=e(t).parents(".brix-section-row").first(),r=e(t).parents(n).first().outerHeight();e(n,i).css("min-height",r),e(".brix-frontend-sortable").sortable("refreshPositions")}return!1},i=function(){},r=function(t,n){var i="<span>"+e(".brix-block-frontend-editing-placeholder svg",n)[0].outerHTML+"</span>",r="";return n.hasClass("brix-section-column-block")&&(r="brix-sortable-block"),e('<div class="brix-sortable-helper '+r+'">'+i+'</div">')};window.BrixFrontendEditingSortable=function(t,o,s,c,d){var a=this;this.start_coords=null,this.end_coords=null,this.get_start_coords=function(e){var t=0;e.hasClass("brix-section-column-block")&&(t=e.index(".brix-section-column-block")),this.start_coords={index:t}},this.get_end_coords=function(e){var t=0,n=0;if(e.hasClass("brix-section-column-block")){n=e.parents(".brix-section-column").index(".brix-section-column");t=e.index()}this.end_coords={index:t,column:n}};var l={handle:s,items:o,helper:r,forcePlaceholderSize:!0,tolerance:"pointer",distance:10,cursorAt:d,appendTo:document.body,start:function(r,o){n(o.item),e(t).addClass("brix-drop-area"),e("body").addClass("brix-dragging"),e("brix-frontend-sortable").sortable("refreshPositions"),a.get_start_coords(o.item),i()},stop:function(n,i){e(t).removeClass("brix-drop-area"),e("body").removeClass("brix-dragging"),e(".brix-section-column-inner-wrapper").css("min-height",""),window.brix_frontend_editing.clear(),e(i.item).attr("style",""),a.get_end_coords(i.item),window.parent.brix_frontend_editing.move_block(a.start_coords,a.end_coords),e(".brix-section-column-inner-wrapper").filter(function(){return 0==e(this).children().length}).html(""),window.parent.brix_frontend_editing.update(!0)}};c&&(l.connectWith=c),e(t).addClass("brix-frontend-sortable"),e(t).data("sortable")?e(t).sortable("refresh"):e(t).sortable(l)},e(window).on("brix_ready",function(){new BrixFrontendEditingSortable(t,".brix-section-column-block",!1,t,{top:24,left:24})}),e(window).on("resize",function(){var t=e("body").hasClass("brix-frontend-preview-mode");e(".brix-frontend-sortable").each(function(){t?e(this).sortable("disable"):e(this).sortable("enable")})})}(jQuery);